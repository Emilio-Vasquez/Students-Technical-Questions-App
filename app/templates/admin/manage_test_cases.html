{% extends "base.html" %}

{% block title %}Manage Test Cases - {{ question.title }}{% endblock %}

{% block content %}
<div class="test-case-container" style="max-width: 960px; margin: auto; padding: 2rem;">
    <h2 style="text-align: center; margin-bottom: 2rem;">
        Manage Test Cases for <em>{{ question.title }}</em>
    </h2>

    <form method="POST" action="{{ url_for('admin.manage_test_cases', question_id=question.id) }}" class="test-case-form" style="background-color: #fdfdfd; padding: 2rem; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.08);">
        <div class="form-group" style="margin-bottom: 1.5rem;">
            <label for="description"><strong>Description:</strong></label>
            <textarea name="description" id="description" rows="3" required style="width: 100%; padding: 0.75rem; border-radius: 4px; border: 1px solid #ccc;"></textarea>
        </div>

        <div class="form-group" style="margin-bottom: 1.5rem;">
            <label for="input"><strong>Input <span style="font-weight: normal;">(JSON format)</span>:</strong></label>
            <textarea name="input" id="input" rows="3" required placeholder='e.g. {"nums": [1, 2], "target": 3}' style="width: 100%; padding: 0.75rem; border-radius: 4px; border: 1px solid #ccc;"></textarea>
        </div>

        <div class="form-group" style="margin-bottom: 1.5rem;">
            <label for="expected_output"><strong>Expected Output <span style="font-weight: normal;">(JSON format)</span>:</strong></label>
            <textarea name="expected_output" id="expected_output" rows="3" required placeholder='e.g. [0, 1]' style="width: 100%; padding: 0.75rem; border-radius: 4px; border: 1px solid #ccc;"></textarea>
        </div>

        <div class="form-group" id="setup_sql_group" style="margin-bottom: 1.5rem;">
            <label for="setup_sql"><strong>Setup SQL <span style="font-weight: normal;">(for SQL problems)</span>:</strong></label>
            <textarea name="setup_sql" id="setup_sql" rows="3" style="width: 100%; padding: 0.75rem; border-radius: 4px; border: 1px solid #ccc;"></textarea>
        </div>

        <div style="text-align: right;">
            <button type="submit" class="btn" style="padding: 0.6rem 1.2rem; background-color: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer;">
                ➕ Add Test Case
            </button>
        </div>
    </form>

    <hr style="margin: 3rem 0;">

    <h3 style="margin-bottom: 1.5rem;">Existing Test Cases</h3>
    {% if test_cases %}
        <div class="test-case-list">
            {% for tc in test_cases %}
                <div class="test-case-card" style="background-color: #fafafa; border: 1px solid #ddd; border-radius: 6px; padding: 1rem; margin-bottom: 1.5rem;">
                    <p><strong>Description:</strong> {{ tc.description }}</p>
                    <p><strong>Input:</strong> <code>{{ tc.input }}</code></p>
                    <p><strong>Expected Output:</strong> <code>{{ tc.expected_output }}</code></p>
                    {% if tc.setup_sql %}
                        <p><strong>Setup SQL:</strong></p>
                        <pre style="background-color: #f5f5f5; padding: 0.75rem; border-radius: 4px; overflow-x: auto;">{{ tc.setup_sql }}</pre>
                    {% endif %}
                </div>
            {% endfor %}
        </div>
    {% else %}
        <p style="color: #777;">No test cases have been added yet.</p>
    {% endif %}

    <p style="margin-top: 2rem;">
        <a href="{{ url_for('admin.edit_question_list') }}" style="text-decoration: none; color: #007bff;">← Back to Questions</a>
    </p>
</div>

<script src="{{ url_for('static', filename='js/test_cases.js') }}"></script>
<script>
    window.questionLanguage = "{{ question.language | lower }}";
</script>
{% endblock %}
